# 模块系统

---

## 模块概述

  * ES6之前，JS中没有模块的概念，所有要执行的JS文件运行在同一个空间中，容易产生对象覆盖问题。Node.js使用“Module（模块）”来划分不同的功能对象：
    * Node.js中每一个.js 文件对应一个模块对象
    * 模块内声明的变量或函数的作用域是“模块作用域——默认只能在当前JS文件（即当前模块）中使用”，而不是全局作用域
    * 每个模块可以导出（exports）自己内部的成员供其它模块使用，也可以引入（require）并使用其它模块中导出的成员
    * Node.js启动时运行的第一个模块称为“主模块”（main module）

## 模块分类

  * 核心模块
    * node.js 提供，被编译进二进制执行文件，可以被解释器直接使用，加载速度最快
  * 第三方模块
    * 基于Node.js核心模块，很多组织和个人提供了大量的第三方扩展应用
    * 常用的第三方模块：express、less、webpack
  * 自定义模块
    * 文件式自定义模块
    * 目录式自定义模块

## 核心模块

  * 也叫绝对模块，指 node.js 的内置模块，无需下载，直接使用即可

    模块名|说明
    ---|---
    global| 全局对象模块
    console| 控制台模块
    util| 提供常用函数的集合
    events| 实现了Node.js的事件驱动型的异步调用
    fs| 文件系统I/O操作模块
    http| 提供基于HTTP 协议的请求和响应
    net| 提供基于Socket的网络连接
    dns| DNS解析服务模块
    crypto| 加密和解密功能模块

## 加载模块

  * require()函数用于加载一个模块，其可用的参数有如下形式
    * 原生模块名
    * 文件模块的相对路径
    * 文件模块的绝对路径
    * 非原生模块的文件模块名
  * 使用 require 加载并调用核心模块
  
# 自定义模块

---

## 创建模块

  * 文件式自定义模块
    * 创建 js 文件，包含功能代码，并使用 exports 公开接口
    * exports：对module.exports的引用，用于导出当前模块中的成员供其它模块使用
  * Node.js中的每个.js文件都自成一个模块，有自己专属的成员属性和方法——“模块作用域”变量
    * 模块文件中声明的变量和函数也都属于“模块作用域”
  * Node.js在编译模块文件时会对其首尾进行如下的包装：

## 加载模块

  * 其他 js 文件中调用
    * 使用 require 包含一个相对工作目录中的 js 文件

## 覆盖 exports

  * 重写 module.exports，实现对象的封装
    * require 调用时会得到一个对象

## 目录式自定义模块

  * 模块与文件一一对应
    * 可以是单个文件：js代码文件，或者二进制代码文件
    * 可以是文件夹—文件夹封装为模块，即为package
  * 目录式自定义模块中，需要创建一个 index.js 文件，作为该模块的入口文件
  * 为 index.js 文件添加代码，并在文件夹外的 js 文件中调用